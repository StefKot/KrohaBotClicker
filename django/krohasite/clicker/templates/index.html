{% extends "base.html" %}
{% load static %}

{% block title %}Main{% endblock %}

{% block css %}
<style>
  .progress-bar {
      background-color: #76b7eb !important;
  }

 .button-container {
     display: flex; 
     justify-content: center; 
  }

 .button {
     background-color: #2578ba;
     border: none;
     color: white;
     padding: 15px 32px;
     text-align: center;
     text-decoration: none;
     display: inline-block;
     font-size: 16px;
     margin: 4px 2px;
     cursor: pointer;
     border-radius: 5px; 
  }
 .button:hover {
     background-color: #0056b3; 
  }
</style>
{% endblock %}


{% block body %}
<div id="score" style="color: #fff; text-align: center; font-size: 3rem">0</div>
<div id="image-container" style="margin: auto; text-align: center;">
    <img src= "{% static 'kroha.png' %}"
       style="max-width: 100%; animation: scale 600ms ease; margin: auto;">
  <div id="score-counter"
       style="font-size: 50px; color: #fff; opacity: 0; animation: bounce-in 600ms;"></div>
</div>


<div class="progress" role="progressbar" aria-label="Basic example"
     aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="background-color:#2578ba;">
  <div id="progress-bar" class="progress-bar progress-bar-striped progress-bar-animated" style="width: 0%"></div>
</div>


<div class="button-container">
  <a href="/store" class="button">üè¨<br>Store</a>
  <a href="/rating" class="button">‚≠êÔ∏è<br>Rating</a>
  <a href="/profile" class="button">üôç‚Äç‚ôÇÔ∏è<br>Profile</a>
</div>


<audio id="audio" src="{% static 'baby.mp3' %}"></audio>

<div id="toast-container" class="toast-container position-static"
     style="margin: auto">
</div>

<script>
 let score = 0;
 let tapPosition = [0, 0];

 document.getElementById('image-container').addEventListener('click', async function() {
   document.getElementById('audio').play();

   score++;
   document.getElementById('score').innerText = score;

   let image = document.querySelector('#image-container img');
   image.style.transform = 'scale(0.95)';

   let scoreCounter = document.getElementById('score-counter');
   scoreCounter.style.opacity = 1;
   scoreCounter.innerText = "+1";
   scoreCounter.style.right = "0";
   scoreCounter.style.left = tapPosition[0] + "px";
   scoreCounter.style.top = tapPosition[1] + "px";
   scoreCounter.style.bottom = "0";

   let progressBar = document.getElementById('progress-bar');
   progressBar.style.width = (score % 10)*10 + "%";

   if (score % 10 === 0) {
     let snackBar = document.createElement('div');
     snackBar.className = 'toast';
     snackBar.innerHTML = '<div class="toast-body" style="background: #2578ba; color: #fff; text-align: center">üë∂üèº +10</div>';

     const toastBootstrap = bootstrap.Toast.getOrCreateInstance(
       snackBar,
       {delay: 1000},
     );

     document.getElementById('toast-container').appendChild(snackBar);
     toastBootstrap.show();

   }

   await new Promise(resolve => setTimeout(resolve, 500));
   image.style.transform = 'scale(1)';
   scoreCounter.style.opacity = 0;
 });

 document.getElementById('image-container').addEventListener('mousedown', function(event) {
   tapPosition = [event.clientX, event.clientY];
 });

</script>
{% endblock %}
